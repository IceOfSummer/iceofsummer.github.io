mixins.crypto={data:()=>({crypto:"",check:!1}),methods:{SHA:t=>CryptoJS.SHA256(t).toString(),decrypt(t,e,c){try{let s=CryptoJS.AES.decrypt(t,e).toString(CryptoJS.enc.Utf8);return{check:this.SHA(s)===c,decrypted:s}}catch{return{check:!1}}}},watch:{crypto(t){let e=this.$refs.crypto,c=this.$refs.content,{decrypted:s,check:r}=this.decrypt(e.dataset.encrypted,t,e.dataset.shasum);this.check=r,r?(e.classList.remove("fail"),e.classList.add("success"),e.disabled=!0,c.innerHTML=s,this.render()):e.classList.add("fail")}}},mixins.push(cryptoMixin);