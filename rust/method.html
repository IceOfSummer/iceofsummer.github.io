
<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="UTF-8" />
        <title>方法 Method | IceOfSummerの博客</title>
        <meta name="author" content="IceOfSummer" />
        <meta name="description" content="后面一辈子的博客都在这了！" />
        <meta name="keywords" content="" />
        <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0" />
        <script src="https://cdn.staticfile.org/vue/3.2.47/vue.global.prod.min.js"></script>
<link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/6.3.0/css/all.min.css" />
<link rel="stylesheet" href="https://selfb.asia/static/particlex/static/fonts.min.css" />
<script>
  const mixins = {};
  const h = (arg1, arg2, arg3) => {
    if (arg2.attrs) {
      Object.assign(arg2, arg2.attrs)
      Reflect.deleteProperty(arg2, 'attrs')
    }
    if (arg2.on) {
      Object.keys(arg2.on).forEach(key => {
        const head = key.charAt(0).toUpperCase()
        arg2['on' + head  + key.substring(1)] = arg2.on[key]
      })
      Reflect.deleteProperty(arg2, 'on')
    }
    return Vue.h(arg1, arg2, arg3)
  }
</script>

<script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>


<script src="https://cdn.staticfile.org/highlight.js/11.7.0/highlight.min.js"></script>
<link
    rel="stylesheet"
    href="https://cdn.staticfile.org/highlight.js/11.7.0/styles/github.min.css"
/>
<script src="/js/lib/highlight.js"></script>



<script src="/js/lib/preview.js"></script>









<link rel="stylesheet" href="/css/main.css" />

  <script src="/js/lib/toc.js"></script>



  <script src="/js/lib/lazy-load-support.js"></script>


    <meta name="generator" content="Hexo 7.3.0"></head>
    <body>
        <div id="layout">
            <transition name="fade">
            <div id="loading" v-show="loading">
                <div id="loading-circle">
                    <h2>LOADING</h2>
                    <p>加载过慢请开启缓存&ensp;浏览器默认开启</p>
                    <img src="/images/loading.gif" />
                </div>
            </div>
            </transition>
            <transition name="into">
            <div id="main" v-show="!loading">
                <nav id="menu" ref="menu">
    <div class="desktop-menu">
        <a class="title" href="/">
            <span>ICEOFSUMMERの博客</span>
        </a>
        
        <a href="/">
            <i class="fa-solid fa-house fa-fw"></i>
            <span>&ensp;Home</span>
        </a>
        
        <a href="/about">
            <i class="fa-solid fa-id-card fa-fw"></i>
            <span>&ensp;About</span>
        </a>
        
        <a href="/archives">
            <i class="fa-solid fa-box-archive fa-fw"></i>
            <span>&ensp;Archives</span>
        </a>
        
        <a href="/categories">
            <i class="fa-solid fa-bookmark fa-fw"></i>
            <span>&ensp;Categories</span>
        </a>
        
        <a href="/tags">
            <i class="fa-solid fa-tags fa-fw"></i>
            <span>&ensp;Tags</span>
        </a>
        
    </div>
    <div id="mobile-menu">
        <div class="curtain" v-show="showMenu" @click="showMenu = !showMenu"></div>
        <div class="title" @click="showMenu = !showMenu">
            <i class="fa-solid fa-bars fa-fw"></i>
            <span>&emsp;ICEOFSUMMERの博客</span>
        </div>
        <transition name="slide">
        <div class="items" v-show="showMenu">
            
            <a href="/">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-house fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Home</div>
                </div>
            </a>
            
            <a href="/about">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-id-card fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">About</div>
                </div>
            </a>
            
            <a href="/archives">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-box-archive fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Archives</div>
                </div>
            </a>
            
            <a href="/categories">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-bookmark fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Categories</div>
                </div>
            </a>
            
            <a href="/tags">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-tags fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Tags</div>
                </div>
            </a>
            
        </div>
        </transition>
    </div>
</nav>

                <div class="article">
    <div>
        <h1>方法 Method</h1>
    </div>
    <div class="info">
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2024/1/12
        </span>
        
        <span class="category">
            <a href="/2023/12/04/rust/">
                <span class="icon">
                    <i class="fa-solid fa-bookmark fa-fw"></i>
                </span>
                Rust
            </a>
        </span>
        
        
    </div>
    
    <toc-component></toc-component>
    <div class="content" v-pre id="main-content">
        <h1 id="1-定义方法"><a href="#1-定义方法" class="headerlink" title="1. 定义方法"></a>1. 定义方法</h1><p>Rust 使用 impl 来定义方法，例如以下代码：</p>
<pre><code class="rust">struct Circle &#123;
    x: f64,
    y: f64,
    radius: f64,
&#125;

impl Circle &#123;
    // new是Circle的关联函数，因为它的第一个参数不是self，且new并不是关键字
    // 这种方法往往用于初始化当前结构体的实例
    fn new(x: f64, y: f64, radius: f64) -&gt; Circle &#123;
        Circle &#123;
            x: x,
            y: y,
            radius: radius,
        &#125;
    &#125;

    // Circle的方法，&amp;self表示借用当前的Circle结构体
    fn area(&amp;self) -&gt; f64 &#123;
        std::f64::consts::PI * (self.radius * self.radius)
    &#125;
&#125;
</code></pre>
<p>Rust和其它语言，例如Java中的类不同的是，<code>impl</code>只能用来定义方法，里面不能包括属性，而Java中的类既可以有方法，也可以有属性。<br>如果需要使用属性，需要搭配结构体使用。</p>
<p>如果<code>impl</code>和<code>struct</code>的名称相同，则两者会被视作同一个：</p>
<pre><code class="rust">#[derive(Debug)]
struct Rectangle &#123;
    width: u32,
    height: u32,
&#125;

impl Rectangle &#123;
    fn area(&amp;self) -&gt; u32 &#123;
        self.width * self.height
    &#125;
&#125;

fn main() &#123;
    let rect1 = Rectangle &#123; width: 30, height: 50 &#125;;

    println!(
        &quot;The area of the rectangle is &#123;&#125; square pixels.&quot;,
        rect1.area()
    );
&#125;
</code></pre>
<h2 id="self、-self和-mut-self"><a href="#self、-self和-mut-self" class="headerlink" title="self、&amp;self和&amp;mut self"></a>self、&amp;self和&amp;mut self</h2><p>在上面 <code>area`` 的签名中，我们使用 </code>&amp;self<code>替代</code>rectangle: &amp;Rectangle<code>，</code>&amp;self<code>其实是</code>self: &amp;Self<code>的简写（注意大小写）。在一个</code>impl<code> 块内，</code>Self<code> 指代被实现方法的结构体类型，</code>self<code> 指代此类型的实例，换句话说，</code>self<code>指代的是</code>Rectangle<code>结构体实例，这样的写法会让我们的代码简洁很多，而且非常便于理解：我们为哪个结构体实现方法，那么</code>self&#96; 就是指代哪个结构体的实例。</p>
<p>需要注意的是，self 依然有所有权的概念：</p>
<ul>
<li>self 表示 Rectangle 的所有权转移到该方法中，这种形式用的较少</li>
<li>&amp;self 表示该方法对 Rectangle 的不可变借用</li>
<li>&amp;mut self 表示可变借用</li>
</ul>
<h1 id="2-关联函数"><a href="#2-关联函数" class="headerlink" title="2. 关联函数"></a>2. 关联函数</h1><p>参数中不包含 <code>self</code> 的函数就是关联函数，注意是函数而不是方法。</p>
<pre><code class="rust">impl Rectangle &#123;
    fn new(w: u32, h: u32) -&gt; Rectangle &#123;
        Rectangle &#123; width: w, height: h &#125;
    &#125;
&#125;
</code></pre>
<p>在Rust中，并没有构造器的概念，也就是说构造一个对象并不一定需要调用<code>new</code>方法，而<code>new</code>方法在语法层面也并不代表构造器，只是一个<br>约定俗成的规则，Rust里使用new作为构造器的名称。</p>
<p>因为是函数，所以不能用<code>.</code>来调用，只能通过<code>::</code>来调用，例如<code>String::from</code>。</p>
<h1 id="3-多个impl定义"><a href="#3-多个impl定义" class="headerlink" title="3. 多个impl定义"></a>3. 多个impl定义</h1><p>Rust 允许我们为一个结构体定义多个 impl 块，目的是提供更多的灵活性和代码组织性，例如当方法多了后，可以把相关的方法组织在同一个 impl 块中，那么就可以形成多个 impl 块，各自完成一块儿目标：</p>
<pre><code class="rust">impl Rectangle &#123;
    fn area(&amp;self) -&gt; u32 &#123;
        self.width * self.height
    &#125;
&#125;

impl Rectangle &#123;
    fn can_hold(&amp;self, other: &amp;Rectangle) -&gt; bool &#123;
        self.width &gt; other.width &amp;&amp; self.height &gt; other.height
    &#125;
&#125;
</code></pre>
<h1 id="4-为枚举实现方法"><a href="#4-为枚举实现方法" class="headerlink" title="4. 为枚举实现方法"></a>4. 为枚举实现方法</h1><p>枚举类型之所以强大，不仅仅在于它好用、可以同一化类型，还在于，我们可以像结构体一样，为枚举实现方法：</p>
<pre><code class="rust">#![allow(unused)]
enum Message &#123;
    Quit,
    Move &#123; x: i32, y: i32 &#125;,
    Write(String),
    ChangeColor(i32, i32, i32),
&#125;

impl Message &#123;
    fn call(&amp;self) &#123;
        // 在这里定义方法体
    &#125;
&#125;

fn main() &#123;
    let m = Message::Write(String::from(&quot;hello&quot;));
    m.call();
&#125;
</code></pre>

    </div>
    
    
    
    
    <div id="comment">
        <div id="giscus-container" class="giscus"></div>
    </div>
    
    
    
    
</div>

                <footer id="footer">
    <div id="footer-wrap">
        <div>
            &copy;
            2022 - 2024 IceOfSummerの博客
            <span id="footer-icon">
                <i class="fa-solid fa-font-awesome fa-fw"></i>
            </span>
            &commat;<a target="_blank" rel="noopener" href="https://github.com/IceOfSummer">IceOfSummer</a>
        </div>
        <div>
            Based on the <a target="_blank" rel="noopener" href="https://hexo.io">Hexo Engine</a> &amp;
            <a target="_blank" rel="noopener" href="https://github.com/IceOfSummer/hexo-theme-particlex">ParticleX Theme</a>
        </div>
        
    </div>
</footer>

            </div>
            </transition>
            
            <transition name="fade">
            <div id="preview" ref="preview" v-show="previewShow">
                <img id="preview-content" ref="previewContent" />
            </div>
            </transition>
            
        </div>
        <script src="/js/main.js"></script>
        
        
<script
    src="https://giscus.app/client.js"
    data-repo="IceOfSummer/iceofsummer.github.io"
    data-repo-id="R_kgDOJFU7OQ"
    data-category="Announcements"
    data-category-id="DIC_kwDOJFU7Oc4CUyC7"
    data-mapping="title"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="top"
    data-theme="preferred_color_scheme"
    data-lang="zh-CN"
    crossorigin
    async
></script>





        
    </body>
</html>
